#!/usr/bin/env python3
# This file is placed in the Public Domain.


"create docs"


import os
import subprocess
import sys


os.environ["PATH"] += ":bin"


def popen(txt):
    "run commands"
    with subprocess.Popen(
                            txt.split(),
                            stdin=sys.stdin,
                            stdout=sys.stdout,
                            stderr=sys.stderr,
                            close_fds=False,
                            text=True
                           ) as proc:
        proc.communicate()
        proc.wait()


popen("clean")


if not os.path.exists("env"):
    popen("mkenv")


#if not os.path.exists("env/bin/sphinx-build"):
#    popen("upenv")

popen("env/bin/python3 -m pip install -r docs/requirements.txt --upgrade")
#popen("env/bin/python3 -m pip install genocide -f dist --force-reinstall")
popen("env/bin/python3 env/bin/sphinx-build docs html")
